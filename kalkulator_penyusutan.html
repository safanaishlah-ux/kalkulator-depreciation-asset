<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2299.77">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="id"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;Kalkulator Penyusutan Aset&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Memuat Tailwind CSS dari CDN --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Menggunakan font Inter */</p>
<p class="p1"><span class="Apple-converted-space">        </span>@import url('https_//fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap');</p>
<p class="p1"><span class="Apple-converted-space">        </span>body {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-family: 'Inter', sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Style untuk input number agar tidak menampilkan panah spinner */</p>
<p class="p1"><span class="Apple-converted-space">        </span>input[type=number]::-webkit-inner-spin-button,</p>
<p class="p1"><span class="Apple-converted-space">        </span>input[type=number]::-webkit-outer-spin-button {</p>
<p class="p1"><span class="Apple-converted-space">            </span>-webkit-appearance: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>input[type=number] {</p>
<p class="p1"><span class="Apple-converted-space">            </span>-moz-appearance: textfield;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body class="bg-gray-100 font-inter min-h-screen flex items-center justify-center p-4"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="w-full max-w-4xl mx-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="bg-white rounded-xl shadow-xl overflow-hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="p-8 md:p-10"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h1 class="text-3xl font-bold text-gray-800 mb-6 text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>Kalkulator Penyusutan Aset</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p class="text-center text-gray-600 mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>Hitung penyusutan aset menggunakan metode Garis Lurus atau Saldo Menurun Ganda.</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/p&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Form Input --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;form id="depreciation-form" class="grid grid-cols-1 md:grid-cols-2 gap-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="asset-cost" class="block text-sm font-medium text-gray-700 mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>Harga Perolehan Aset (Rp)</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="number" id="asset-cost" placeholder="Contoh: 120000000"</p>
<p class="p1"><span class="Apple-converted-space">                               </span>class="w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg p-3" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="salvage-value" class="block text-sm font-medium text-gray-700 mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>Nilai Residu / Sisa (Rp)</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="number" id="salvage-value" placeholder="Contoh: 20000000"</p>
<p class="p1"><span class="Apple-converted-space">                               </span>class="w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg p-3" value="0" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="useful-life" class="block text-sm font-medium text-gray-700 mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>Masa Manfaat (Tahun)</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="number" id="useful-life" placeholder="Contoh: 5"</p>
<p class="p1"><span class="Apple-converted-space">                               </span>class="w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg p-3" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="purchase-date" class="block text-sm font-medium text-gray-700 mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>Tanggal Pembelian Aset</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="date" id="purchase-date"</p>
<p class="p1"><span class="Apple-converted-space">                               </span>class="w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg p-3" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Pilihan Metode Baru --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="md:col-span-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;label for="depreciation-method" class="block text-sm font-medium text-gray-700 mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>Metode Penyusutan</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;select id="depreciation-method" class="w-full border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg p-3" required&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="straight-line" selected&gt;Garis Lurus (Straight-Line)&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;option value="double-declining"&gt;Saldo Menurun Ganda (Double Declining)&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="md:col-span-2 text-center mt-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button type="submit"</p>
<p class="p1"><span class="Apple-converted-space">                                </span>class="w-full md:w-auto bg-blue-600 text-white px-10 py-3 rounded-lg font-semibold text-lg hover:bg-blue-700 transition duration-300 shadow-md"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>Hitung Jadwal Penyusutan</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/form&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Container untuk Pesan Error --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="error-message" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mt-6" role="alert"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span class="block sm:inline" id="error-text"&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Container Hasil --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="results-container" class="hidden px-8 md:px-10 pb-10"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h2 class="text-2xl font-bold text-gray-800 mb-6 text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>Jadwal Penyusutan Aset</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/h2&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Ringkasan Perhitungan --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="bg-gray-50 p-6 rounded-lg mb-6 grid grid-cols-1 md:grid-cols-2 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Ringkasan Baru untuk Metode --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-sm text-gray-600"&gt;Metode&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-xl font-semibold text-gray-900" id="summary-method"&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Kontainer untuk ringkasan SL --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="summary-annual-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-sm text-gray-600"&gt;Penyusutan per Tahun (Penuh)&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-xl font-semibold text-gray-900" id="summary-annual"&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="summary-monthly-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-sm text-gray-600"&gt;Penyusutan per Bulan&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-xl font-semibold text-gray-900" id="summary-monthly"&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-sm text-gray-600"&gt;Tahun Pertama (Bulan)&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-xl font-semibold text-gray-900" id="summary-first-year"&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-sm text-gray-600"&gt;Tahun Terakhir (Bulan)&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-xl font-semibold text-gray-900" id="summary-last-year"&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Tabel Hasil --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="overflow-x-auto shadow-md rounded-lg"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;table class="min-w-full divide-y divide-gray-200"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;thead class="bg-gray-50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;Tahun&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;Deskripsi&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;Penyusutan Tahunan&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;Akumulasi Penyusutan&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"&gt;Nilai Buku&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;tbody id="schedule-body" class="bg-white divide-y divide-gray-200"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Baris akan ditambahkan oleh JavaScript --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const form = document.getElementById('depreciation-form');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const resultsContainer = document.getElementById('results-container');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const scheduleBody = document.getElementById('schedule-body');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const errorContainer = document.getElementById('error-message');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const errorText = document.getElementById('error-text');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Helper untuk format mata uang IDR</p>
<p class="p1"><span class="Apple-converted-space">        </span>function formatCurrency(value) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>return new Intl.NumberFormat('id-ID', {</p>
<p class="p1"><span class="Apple-converted-space">                </span>style: 'currency',</p>
<p class="p1"><span class="Apple-converted-space">                </span>currency: 'IDR',</p>
<p class="p1"><span class="Apple-converted-space">                </span>minimumFractionDigits: 0,</p>
<p class="p1"><span class="Apple-converted-space">                </span>maximumFractionDigits: 0</p>
<p class="p1"><span class="Apple-converted-space">            </span>}).format(value);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Fungsi untuk menampilkan error</p>
<p class="p1"><span class="Apple-converted-space">        </span>function showError(message) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>errorText.textContent = message;</p>
<p class="p1"><span class="Apple-converted-space">            </span>errorContainer.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>resultsContainer.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Fungsi untuk menyembunyikan error</p>
<p class="p1"><span class="Apple-converted-space">        </span>function clearError() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>errorContainer.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- FUNGSI KALKULASI DIPISAH ---</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/**</p>
<p class="p1"><span class="Apple-converted-space">         </span>* Menghitung jadwal penyusutan Garis Lurus (Straight-Line)</p>
<p class="p1"><span class="Apple-converted-space">         </span>*/</p>
<p class="p1"><span class="Apple-converted-space">        </span>function calculateStraightLine(cost, salvage, lifeInYears, purchaseMonth, purchaseYear) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const depreciableBase = cost - salvage;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const totalMonthsLife = lifeInYears * 12;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const monthlyDepreciation = depreciableBase / totalMonthsLife;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const annualDepreciation = monthlyDepreciation * 12;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const monthsInFirstYear = 12 - purchaseMonth + 1;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>let accumulatedDep = 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let currentBookValue = cost;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let scheduleHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;tr class="font-medium bg-gray-50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap"&gt;${purchaseYear}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap"&gt;Nilai Awal Perolehan&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap text-right"&gt;-&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap text-right"&gt;-&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap text-right"&gt;${formatCurrency(currentBookValue)}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>let currentYear = purchaseYear;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let totalMonthsDeprecated = 0;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>while (totalMonthsDeprecated &lt; totalMonthsLife) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>let monthsThisYear = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>let depreciationThisYear = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>let yearLabel = currentYear;</p>
<p class="p1"><span class="Apple-converted-space">                </span>let description = '';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (totalMonthsDeprecated === 0) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>monthsThisYear = monthsInFirstYear;</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const monthsRemaining = totalMonthsLife - totalMonthsDeprecated;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>monthsThisYear = Math.min(12, monthsRemaining);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (monthsThisYear &lt;= 0) break;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>description = `Tahun ${yearLabel} (${monthsThisYear} ${monthsThisYear &lt; 12 ? 'bulan' : 'bulan penuh'})`;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>let remainingDepreciable = depreciableBase - accumulatedDep;</p>
<p class="p1"><span class="Apple-converted-space">                </span>depreciationThisYear = Math.min(monthlyDepreciation * monthsThisYear, remainingDepreciable);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (totalMonthsDeprecated + monthsThisYear &gt;= totalMonthsLife) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>depreciationThisYear = remainingDepreciable;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>accumulatedDep += depreciationThisYear;</p>
<p class="p1"><span class="Apple-converted-space">                </span>currentBookValue = cost - accumulatedDep;</p>
<p class="p1"><span class="Apple-converted-space">                </span>totalMonthsDeprecated += monthsThisYear;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>scheduleHTML += `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="px-6 py-4 whitespace-nowrap"&gt;${yearLabel}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="px-6 py-4 whitespace-nowrap"&gt;${description}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="px-6 py-4 whitespace-nowrap text-right"&gt;${formatCurrency(depreciationThisYear)}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="px-6 py-4 whitespace-nowrap text-right"&gt;${formatCurrency(accumulatedDep)}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="px-6 py-4 whitespace-nowrap text-right"&gt;${formatCurrency(currentBookValue)}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>currentYear++;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>return {</p>
<p class="p1"><span class="Apple-converted-space">                </span>html: scheduleHTML,</p>
<p class="p1"><span class="Apple-converted-space">                </span>summary: {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>annual: annualDepreciation,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>monthly: monthlyDepreciation</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/**</p>
<p class="p1"><span class="Apple-converted-space">         </span>* Menghitung jadwal penyusutan Saldo Menurun Ganda (Double Declining)</p>
<p class="p1"><span class="Apple-converted-space">         </span>*/</p>
<p class="p1"><span class="Apple-converted-space">        </span>function calculateDoubleDeclining(cost, salvage, lifeInYears, purchaseMonth, purchaseYear) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const rate = 2 / lifeInYears;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const totalMonthsLife = lifeInYears * 12;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const monthsInFirstYear = 12 - purchaseMonth + 1;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>let accumulatedDep = 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let currentBookValue = cost;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let scheduleHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;tr class="font-medium bg-gray-50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap"&gt;${purchaseYear}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap"&gt;Nilai Awal Perolehan&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap text-right"&gt;-&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap text-right"&gt;-&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;td class="px-6 py-4 whitespace-nowrap text-right"&gt;${formatCurrency(currentBookValue)}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>let currentYear = purchaseYear;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let totalMonthsDeprecated = 0;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>while (totalMonthsDeprecated &lt; totalMonthsLife) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>let bookValueAtStartOfYear = currentBookValue;</p>
<p class="p1"><span class="Apple-converted-space">                </span>let monthsThisYear = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>let description = '';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (totalMonthsDeprecated === 0) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>monthsThisYear = monthsInFirstYear;</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const monthsRemaining = totalMonthsLife - totalMonthsDeprecated;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>monthsThisYear = Math.min(12, monthsRemaining);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (monthsThisYear &lt;= 0) break;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>description = `Tahun ${currentYear} (${monthsThisYear} ${monthsThisYear &lt; 12 ? 'bulan' : 'bulan penuh'})`;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Kalkulasi DD</p>
<p class="p1"><span class="Apple-converted-space">                </span>const fullAnnualDep = bookValueAtStartOfYear * rate;</p>
<p class="p1"><span class="Apple-converted-space">                </span>let depreciationThisYear = fullAnnualDep * (monthsThisYear / 12);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Cek batas nilai residu</p>
<p class="p1"><span class="Apple-converted-space">                </span>const remainingValueToDepreciate = currentBookValue - salvage;</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (depreciationThisYear &gt; remainingValueToDepreciate) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>depreciationThisYear = Math.max(0, remainingValueToDepreciate);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Pastikan di akhir tidak kurang dari nilai residu</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (totalMonthsDeprecated + monthsThisYear &gt;= totalMonthsLife) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>depreciationThisYear = Math.max(0, currentBookValue - salvage);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>accumulatedDep += depreciationThisYear;</p>
<p class="p1"><span class="Apple-converted-space">                </span>currentBookValue -= depreciationThisYear;</p>
<p class="p1"><span class="Apple-converted-space">                </span>totalMonthsDeprecated += monthsThisYear;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>scheduleHTML += `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="px-6 py-4 whitespace-nowrap"&gt;${currentYear}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="px-6 py-4 whitespace-nowrap"&gt;${description}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="px-6 py-4 whitespace-nowrap text-right"&gt;${formatCurrency(depreciationThisYear)}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="px-6 py-4 whitespace-nowrap text-right"&gt;${formatCurrency(accumulatedDep)}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;td class="px-6 py-4 whitespace-nowrap text-right"&gt;${formatCurrency(currentBookValue)}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>currentYear++;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>return { html: scheduleHTML, summary: {} }; // Tidak ada summary bulanan/tahunan yg konstan</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>form.addEventListener('submit', function(e) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>e.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">            </span>clearError();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const cost = parseFloat(document.getElementById('asset-cost').value);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const salvage = parseFloat(document.getElementById('salvage-value').value);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const lifeInYears = parseFloat(document.getElementById('useful-life').value);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const purchaseDateStr = document.getElementById('purchase-date').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const method = document.getElementById('depreciation-method').value;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Validasi Input</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (isNaN(cost) || isNaN(salvage) || isNaN(lifeInYears) || !purchaseDateStr) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>showError('Semua field harus diisi dengan angka yang valid.');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (cost &lt;= 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>showError('Harga perolehan aset harus lebih besar dari nol.');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (salvage &lt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>showError('Nilai residu tidak boleh negatif.');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">             </span>if (lifeInYears &lt;= 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>showError('Masa manfaat harus lebih besar dari nol.');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (salvage &gt;= cost) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>showError('Nilai residu harus lebih kecil dari harga perolehan aset.');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const purchaseDate = new Date(purchaseDateStr);</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Tambah 1 hari untuk menghindari masalah zona waktu saat mengambil tanggal</p>
<p class="p1"><span class="Apple-converted-space">            </span>const safePurchaseDate = new Date(purchaseDate.getTime() + (purchaseDate.getTimezoneOffset() * 60000) + (24 * 60 * 60000));</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const purchaseMonth = safePurchaseDate.getMonth() + 1; // 1-12</p>
<p class="p1"><span class="Apple-converted-space">            </span>const purchaseYear = safePurchaseDate.getFullYear();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// --- Logika Kalkulasi ---</p>
<p class="p1"><span class="Apple-converted-space">            </span>const totalMonthsLife = lifeInYears * 12;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const monthsInFirstYear = 12 - purchaseMonth + 1;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const monthsInLastYear = (totalMonthsLife - monthsInFirstYear) % 12;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>let calculation;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const summaryAnnualContainer = document.getElementById('summary-annual-container');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const summaryMonthlyContainer = document.getElementById('summary-monthly-container');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (method === 'straight-line') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>calculation = calculateStraightLine(cost, salvage, lifeInYears, purchaseMonth, purchaseYear);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Tampilkan ringkasan SL</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('summary-annual').textContent = formatCurrency(calculation.summary.annual);</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('summary-monthly').textContent = formatCurrency(calculation.summary.monthly);</p>
<p class="p1"><span class="Apple-converted-space">                </span>summaryAnnualContainer.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">                </span>summaryMonthlyContainer.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('summary-method').textContent = "Garis Lurus";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (method === 'double-declining') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>calculation = calculateDoubleDeclining(cost, salvage, lifeInYears, purchaseMonth, purchaseYear);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Sembunyikan ringkasan SL</p>
<p class="p1"><span class="Apple-converted-space">                </span>summaryAnnualContainer.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">                </span>summaryMonthlyContainer.style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('summary-method').textContent = "Saldo Menurun Ganda";</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Tampilkan hasil</p>
<p class="p1"><span class="Apple-converted-space">            </span>scheduleBody.innerHTML = calculation.html; // &lt;-- Diubah untuk mengambil HTML dari fungsi</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Isi Ringkasan</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('summary-first-year').textContent = `${monthsInFirstYear} Bulan`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('summary-last-year').textContent = `${monthsInLastYear === 0 ? 12 : monthsInLastYear} Bulan`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>resultsContainer.classList.remove('hidden');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Scroll ke hasil</p>
<p class="p1"><span class="Apple-converted-space">             </span>resultsContainer.scrollIntoView({ behavior: 'smooth' });</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
